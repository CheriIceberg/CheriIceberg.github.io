<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/capsules-solid.svg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/capsules-solid.svg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"cheriiceberg.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.10.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

  <meta name="description" content="文件类型 文件头标识 文件尾标识    .7z 37 7A BC AF 27 1C    .GIF 47 49 46 38 00 3B   .jpg FF D8 FF FF D9   .png 89 50 4E 47 AE 42 60 82   .rar 52 61 72 21 C4 3D 7B 00 40 07 00   .zip 50 4B 03 04 50 4B   .pdf 25 5">
<meta property="og:type" content="article">
<meta property="og:title" content="各类常见文件16进制头文件">
<meta property="og:url" content="https://cheriiceberg.github.io/2022/04/30/file-header/index.html">
<meta property="og:site_name" content="P27の博客">
<meta property="og:description" content="文件类型 文件头标识 文件尾标识    .7z 37 7A BC AF 27 1C    .GIF 47 49 46 38 00 3B   .jpg FF D8 FF FF D9   .png 89 50 4E 47 AE 42 60 82   .rar 52 61 72 21 C4 3D 7B 00 40 07 00   .zip 50 4B 03 04 50 4B   .pdf 25 5">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/504B.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/504B0102.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/0506.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/rarheader.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/yasuowenjian.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/filehead.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/end.png">
<meta property="og:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/png.png">
<meta property="article:published_time" content="2022-04-30T13:58:21.000Z">
<meta property="article:modified_time" content="2022-04-30T13:58:43.935Z">
<meta property="article:author" content="P 27">
<meta property="article:tag" content="MISC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cheriiceberg.github.io/2022/04/30/file-header/504B.png">


<link rel="canonical" href="https://cheriiceberg.github.io/2022/04/30/file-header/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://cheriiceberg.github.io/2022/04/30/file-header/","path":"2022/04/30/file-header/","title":"各类常见文件16进制头文件"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>各类常见文件16进制头文件 | P27の博客</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">P27の博客</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-book fa-fw"></i>留言板</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#0x00-zip%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%BC%AA%E5%8A%A0%E5%AF%86%E5%88%86%E6%9E%90"><span class="nav-text">0x00 zip压缩包伪加密分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0000-%E7%AC%AC%E4%B8%80%E5%9D%97%EF%BC%9A%E5%8E%8B%E7%BC%A9%E6%BA%90%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%E5%9D%97"><span class="nav-text">0000 第一块：压缩源文件数据块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0001-%E7%AC%AC%E4%BA%8C%E5%9D%97%EF%BC%9A%E5%8E%8B%E7%BC%A9%E6%BA%90%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E5%8C%BA"><span class="nav-text">0001 第二块：压缩源文件目录区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0002-%E7%AC%AC%E4%B8%89%E5%9D%97%EF%BC%9A%E5%8E%8B%E7%BC%A9%E6%BA%90%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9D%9F%E6%A0%87%E5%BF%97"><span class="nav-text">0002 第三块：压缩源文件目录结束标志</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0003-%E4%BC%AA%E5%8A%A0%E5%AF%86%E7%9A%84%E8%BE%A8%E5%88%AB%E6%96%B9%E6%B3%95"><span class="nav-text">0003 伪加密的辨别方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0b00-%E6%97%A0%E5%8A%A0%E5%AF%86"><span class="nav-text">0b00 无加密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0b01-%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="nav-text">0b01 伪加密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0b10-%E7%9C%9F%E5%8A%A0%E5%AF%86"><span class="nav-text">0b10 真加密</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x01-RAR%E6%96%87%E4%BB%B6%E5%A4%B4%E8%AF%A6%E7%BB%86%E8%A7%A3%E6%9E%90"><span class="nav-text">0x01 RAR文件头详细解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0000-%E6%A0%87%E8%AE%B0%E5%9D%97"><span class="nav-text">0000 标记块</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0001-%E5%8E%8B%E7%BC%A9%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">0001 压缩文件头</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0002-%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">0002 文件头</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0003-%E7%BB%93%E5%B0%BE%E5%9D%97"><span class="nav-text">0003 结尾块</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#0x02-png%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90"><span class="nav-text">0x02 .png文件分析</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="P 27"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">P 27</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/CheriIceberg" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;CheriIceberg" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://cheriiceberg.github.io/2022/04/30/file-header/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="P 27">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="P27の博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          各类常见文件16进制头文件
        </h1>

        <div class="post-meta-container">
          
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-04-30 21:58:21 / 修改时间：21:58:43" itemprop="dateCreated datePublished" datetime="2022-04-30T21:58:21+08:00">2022-04-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
        </span>
    </span>

  
    <span id="/2022/04/30/file-header/" class="post-meta-item twikoo_visitors" data-flag-title="各类常见文件16进制头文件" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="twikoo_visitors"></span>
    </span>
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <table>
<thead>
<tr>
<th align="left">文件类型</th>
<th align="left">文件头标识</th>
<th align="left">文件尾标识</th>
</tr>
</thead>
<tbody><tr>
<td align="left">.7z</td>
<td align="left">37 7A BC AF 27 1C</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">.GIF</td>
<td align="left">47 49 46 38</td>
<td align="left">00 3B</td>
</tr>
<tr>
<td align="left">.jpg</td>
<td align="left">FF D8 FF</td>
<td align="left">FF D9</td>
</tr>
<tr>
<td align="left">.png</td>
<td align="left">89 50 4E 47</td>
<td align="left">AE 42 60 82</td>
</tr>
<tr>
<td align="left">.rar</td>
<td align="left">52 61 72 21</td>
<td align="left">C4 3D 7B 00 40 07 00</td>
</tr>
<tr>
<td align="left">.zip</td>
<td align="left">50 4B 03 04</td>
<td align="left">50 4B</td>
</tr>
<tr>
<td align="left">.pdf</td>
<td align="left">25 50 44 46 2D 31 2E</td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="0x00-zip压缩包伪加密分析"><a href="#0x00-zip压缩包伪加密分析" class="headerlink" title="0x00 zip压缩包伪加密分析"></a>0x00 zip压缩包伪加密分析</h3><p>zip压缩包16进制数据块的简单分析（详细分析的相关文章非常多，这里不再分析）</p>
<p>需要重点注意三个数据标记块：</p>
<h4 id="0000-第一块：压缩源文件数据块"><a href="#0000-第一块：压缩源文件数据块" class="headerlink" title="0000 第一块：压缩源文件数据块"></a>0000 第一块：压缩源文件数据块</h4><p><img src="/2022/04/30/file-header/504B.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">（并非所有zip都是这样，但是字节位置代表信息一样）</span><br><span class="line">50 4B 03 04 : 头文件标记块（固定）</span><br><span class="line">14 00 ： 解压文件所需要的pkware版本</span><br><span class="line">01 00 ： 全局方式位标记（包含压缩包是否加密，该例子中为加密状态，第二个数		 字是计数则表示加密，偶数为不加密,包括00）</span><br><span class="line">00 00 ： 压缩方式</span><br><span class="line">7A 6D ： 最后修改文件时间</span><br><span class="line">9D 54 ： 最后修改文件日期</span><br><span class="line">E5 93 8C DD ： CRC-32校验码</span><br><span class="line">15 00 00 00 ： 压缩后尺寸</span><br><span class="line">09 00 00 00 ： 未压缩尺寸</span><br><span class="line">08 00 ： 文件名长度</span><br><span class="line">00 00 ： 扩展记录长度</span><br></pre></td></tr></table></figure>

<h4 id="0001-第二块：压缩源文件目录区"><a href="#0001-第二块：压缩源文件目录区" class="headerlink" title="0001 第二块：压缩源文件目录区"></a>0001 第二块：压缩源文件目录区</h4><p><img src="/2022/04/30/file-header/504B0102.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">50 4B 01 02 ： 目录中文件文件头标记</span><br><span class="line">3F 00 ： 压缩使用的pkware版本</span><br><span class="line">14 00 ： 解压文件所需pkware版本</span><br><span class="line">01 00 ： 全局方式位标记（跟数据块一样，这里表示有密码）</span><br><span class="line">00 00 ： 压缩方式</span><br><span class="line">7A 6D ： 最后修改文件时间</span><br><span class="line">9D 54 ： 最后修改文件日期</span><br><span class="line">E5 93 8C DD ： CRC-32校验</span><br><span class="line">15 00 00 00 ： 压缩后尺寸</span><br><span class="line">09 00 00 00 ： 未压缩尺寸</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<h4 id="0002-第三块：压缩源文件目录结束标志"><a href="#0002-第三块：压缩源文件目录结束标志" class="headerlink" title="0002 第三块：压缩源文件目录结束标志"></a>0002 第三块：压缩源文件目录结束标志</h4><p><img src="/2022/04/30/file-header/0506.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">50 4B 05 06 ： 目录结束标志</span><br></pre></td></tr></table></figure>

<h4 id="0003-伪加密的辨别方法"><a href="#0003-伪加密的辨别方法" class="headerlink" title="0003 伪加密的辨别方法"></a>0003 伪加密的辨别方法</h4><h5 id="0b00-无加密"><a href="#0b00-无加密" class="headerlink" title="0b00 无加密"></a>0b00 无加密</h5><p>压缩源文件数据区的全局加密为<code>00 00</code><strong>（或者是其他偶数的数值）</strong>，即图示中第二个方框中的内容</p>
<p>同时压缩源文件目录区的全局方式位标记也为<code>00 00</code><strong>（或者是其他偶数的数值）</strong>（同样是图示中的第二个方框中内容）</p>
<h5 id="0b01-伪加密"><a href="#0b01-伪加密" class="headerlink" title="0b01 伪加密"></a>0b01 伪加密</h5><p>压缩源文件数据区的全局加密为<code>00 00</code> <strong>（或者是其他偶数的数值）</strong>，同时压缩源文件目录区的全局方式位标记为<code>01 00</code><strong>（或者是其他奇数数值）</strong>。发现伪加密时，只要将目录区的数值更改为非加密数值即可</p>
<h5 id="0b10-真加密"><a href="#0b10-真加密" class="headerlink" title="0b10 真加密"></a>0b10 真加密</h5><p>压缩源文件数据区的全局加密为<code>01 00</code> <strong>（或者是其他奇数数值）</strong>，且压缩源文件目录区的全局方式位标记为<code>01 00</code> <strong>（或者是其他奇数数值）</strong></p>
<h3 id="0x01-RAR文件头详细解析"><a href="#0x01-RAR文件头详细解析" class="headerlink" title="0x01 RAR文件头详细解析"></a>0x01 RAR文件头详细解析</h3><p>以上表格中给出的为rar4的16进制文件格式，最新的rar5则有不同的16进制文件格式</p>
<p>头：<code>52 61 72 21 1A 07 01 00</code></p>
<p>尾：<code>1D 77 56 51 03 05 04 00</code></p>
<p>rar5格式的16进制文件并非像rar4一样相对固定，数块的位数（大小）是动态变化的，下面主要解析rar4格式的16进制文件(rar4文件现在比较少见，分析使用攻防世界中MISC的simpleRAR题目的文件)</p>
<p>rar文件通常包含 <strong>标记块</strong>、<strong>压缩文件头块</strong>、<strong>文件头块</strong>、<strong>注释头块</strong>，每一块中都包含以下内容：<br>|名称|大小|说明|<br>|—–|—–|—–|<br>| HEAD_CRC | 2字节 | 所有块或块部分的CRC |<br>|HEAD_TYPE|1字节|块类型|<br>| HEAD_FLAGS   |  2字节     | 块标记 |<br>|HEAD_SIZE|2字节|块大小|</p>
<p>块类型的类型有以下几个：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">标记块：HEAD_TYPE=0x72</span><br><span class="line">压缩文件头：HEAD_TYPE=0x73</span><br><span class="line">文件头：HEAD_TYPE=0x74</span><br><span class="line">旧风格的注释头：HEAD_TYPE=0x75</span><br><span class="line">旧风格的用户身份信息：HEAD_TYPE=0x76</span><br><span class="line">旧风格的子块：HEAD_TYPE=0x77</span><br><span class="line">旧风格的恢复记录：HEAD_TYPE=0X78</span><br><span class="line">旧风格的用户身份信息：HEAD_TYPE=0X79</span><br><span class="line">子块：HEAD_TYPE=0x7A</span><br><span class="line">最后的结束块：HEAD_TYPE=0x7B</span><br></pre></td></tr></table></figure>

<p>下面分析几个数据块</p>
<h4 id="0000-标记块"><a href="#0000-标记块" class="headerlink" title="0000 标记块"></a>0000 标记块</h4><p><img src="/2022/04/30/file-header/rarheader.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">56 61 ： HEAD_CRC,两个字节，所有rar文件都有</span><br><span class="line">72 ： 块类型（HEAD_TYPE），标记块</span><br><span class="line">21 1A ： 块标记（HEAD_FLAGS）,两个字节</span><br><span class="line">07 00  ： 块大小，即56 61 72 21 1A 07 00 一共7个字节</span><br></pre></td></tr></table></figure>

<h4 id="0001-压缩文件头"><a href="#0001-压缩文件头" class="headerlink" title="0001 压缩文件头"></a>0001 压缩文件头</h4><p><img src="/2022/04/30/file-header/yasuowenjian.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">CF 90 ： 压缩文件头CRC校验值</span><br><span class="line">73 ： 头类型，为压缩文件头</span><br><span class="line">00 00 ： 位标记块</span><br><span class="line">0D 00 ： 文件头大小即000D,13字节</span><br><span class="line">后面还有6个保留字节</span><br></pre></td></tr></table></figure>

<h4 id="0002-文件头"><a href="#0002-文件头" class="headerlink" title="0002 文件头"></a>0002 文件头</h4><p><img src="/2022/04/30/file-header/filehead.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">D5 56 ： HEAD_CRC,文件头的CRC校验码</span><br><span class="line">74 ： HEAD_TYPE,块类型，74表示文件头</span><br><span class="line">20 90 ： HEAD_FLAGS</span><br><span class="line">2D 00 ： HEAD_SIZE，文件头全部大小</span><br><span class="line">10 00 00 00 ：PACK_SIZE，已压缩文件大小</span><br><span class="line">10 00 00 00 ：UNP_SIZE，未压缩文件大小</span><br><span class="line">02：HOST_OS，1字节，保存压缩文件使用的操作系统，02代表windows</span><br><span class="line">C7 88 67 36 ：FILE_CRC，4字节，文件的CRC值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="0003-结尾块"><a href="#0003-结尾块" class="headerlink" title="0003 结尾块"></a>0003 结尾块</h4><p><img src="/2022/04/30/file-header/end.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C4 3D 7B 00 40 07 00 ： 固定的结尾块</span><br></pre></td></tr></table></figure>

<p>（所以按照此分析，攻防世界该题目的secret.png的文件头表示应该改成74）</p>
<h3 id="0x02-png文件分析"><a href="#0x02-png文件分析" class="headerlink" title="0x02 .png文件分析"></a>0x02 .png文件分析</h3><p>png文件涉及到高度、宽度的隐写，要分析16进制文件中的高度宽度的位置：</p>
<p><img src="/2022/04/30/file-header/png.png"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">89 50 4E 47 0D 0A 1A 0A ： 开头8个字节，表示png文件</span><br><span class="line">接下来是IHDR数据块</span><br><span class="line">00 00 00 0D ： 表示IHDR数据块长度为13字节</span><br><span class="line">48 49 44 52 ： IHDR标识</span><br><span class="line">00 00 02 C4 ： 表示图像宽，708像素（隐写的关键）</span><br><span class="line">00 00 01 61 ： 表示图像高度，353像素（隐写关键）</span><br><span class="line">08 ： 色深，表示2^8=256色图像</span><br><span class="line">06 ： 颜色类型</span><br><span class="line">00 ： PNG Spec规定此处总为0（非0值为将来使用更好的压缩方法预留），表示使压缩方法(LZ77派生算法)</span><br><span class="line">00 ： 同上</span><br><span class="line">00 ： 非隔行扫描</span><br><span class="line">77 6C BC 43 ： CRC校验码</span><br></pre></td></tr></table></figure>

<p>图像宽度与高度不一定是正确的，可以用CRC校验码进行计算得出，所以图片隐写可以算出真实的高度后进行修改。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>文章结束辣！还有问题可以联系我一起讨论哦！推荐使用留言板哦!TuT</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="https://github.com/CheriIceberg">
          <span class="icon">
            <i class="fab fa-github"></i>
          </span>

          <span class="label">Github</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/MISC/" rel="tag"><i class="fa fa-tag"></i> MISC</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/04/24/burpsuit-extendtion/" rel="prev" title="Burpsuit安装Tplmap扩展（win10环境）">
                  <i class="fa fa-chevron-left"></i> Burpsuit安装Tplmap扩展（win10环境）
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments"><div id="twikoo-comments"></div></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fas fa-capsules"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">P 27</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  




<script class="next-config" data-name="twikoo" type="application/json">{"enable":true,"visitor":true,"envId":"https://twikoo-p91w.vercel.app","el":"#twikoo-comments"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});
</script>

</body>
</html>
